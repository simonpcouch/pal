<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Custom pals • pal</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Custom pals">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pal</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/pal.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/custom.html">Custom pals</a></li>
    <li><a class="dropdown-item" href="../articles/gallery.html">Gallery</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/simonpcouch/pal/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Custom pals</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/simonpcouch/pal/blob/main/vignettes/custom.Rmd" class="external-link"><code>vignettes/custom.Rmd</code></a></small>
      <div class="d-none name"><code>custom.Rmd</code></div>
    </div>

    
    
<p>While the pal package provides a number of pre-engineered pals for R
package development, one can use pals for all sorts of coding tasks in
R, from interactive data analysis to authoring with Quarto, or even for
coding tasks in languages other than R! All you need to set up your own
pal is a markdown file. This vignette provides guidance on how to write
your own pals to help you with repetitive, hard-to-automate tasks.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/simonpcouch/pal" class="external-link">pal</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="what-are-pals-for">What are pals for?<a class="anchor" aria-label="anchor" href="#what-are-pals-for"></a>
</h2>
<p>When building a custom pal, you should first ask yourself a few
questions to help decide whether a pal is the right tool for the
job.</p>
<p><strong>Can this be easily automated without an LLM?</strong> LLMs
are quite good at edge-case rich tasks with “squishy,” hard-to-evaluate
output. Compared to many other pieces of software, LLMs are incredibly
flexible and able to handle edge cases without extensive engineering. At
the same time, their output is not deterministic and always requires
verification. For your given problem, would you be better off spending
the time you’d use to write and revise a prompt and then verifying every
output it makes from then on instead just writing some R code and unit
tests?</p>
<p>Users interface with pals via the active selection. <strong>Would a
selection provide enough context for the pal to do its job?</strong>
That is, besides the fixed system prompt attached to your pal, the only
information the LLM has about your problem is the text that you’ve
selected with your cursor. Would the model need access to a whole file,
or a whole project, in order to do its job? In that case, some interface
other than a pal may be a better fit.</p>
<p>Pals return output by replacing, prefixing, or suffixing the current
selection. <strong>Is this the right place for output in your use
case?</strong> If output ultimately needs to be cut and pasted into a
different file, for example, pals may not be the right tool.</p>
<p>Finally, <strong>is this kind of output immediately
verifiable?</strong> The first element to consider here is how much
stuff the model ultimately generates. A few sentences or a couple lines
of code can be quickly audited and confirmed to be sound. The second
element to consider is whether the output can be programmatically
checked. For example, does generated code run without error (or, at
least, is it syntactically valid)?</p>
<p>Answering these questions can help you better understand whether your
problem is best solved with a pal or, instead, by a human or “normal”
code or some other LLM interface.</p>
</div>
<div class="section level2">
<h2 id="the-prompt-directory">The prompt directory<a class="anchor" aria-label="anchor" href="#the-prompt-directory"></a>
</h2>
<p>The easiest way to write a new pal that’s loaded every time you load
R is to add a markdown file to the <em>prompt directory</em>. The prompt
directory is a folder of markdown files that serves as a library of
possible pals. By default, the prompt directory lives at
<code>~/.config/pal</code>, but that default can be changed by adding a
<code>.pal_dir</code> option in your <code>.Rprofile</code> using
<code>options(pal_dir = some/dir/</code>). <code><a href="../reference/directory.html">directory_path()</a></code>
returns the path to the directory, <code><a href="../reference/directory.html">directory_set()</a></code> changes
it, <code><a href="../reference/directory.html">directory_list()</a></code> enumerates all of the prompts that
currently live in it, and <code><a href="../reference/directory.html">directory_load()</a></code>
registers/refreshes all of the prompts in the directory with the pal
package.</p>
<p>To create a new pal, add a prompt to pal’s prompt directory with
<code><a href="../reference/prompt.html">prompt_new()</a></code>. You’ll need to supply a <code>role</code> (a
single keyword describing what the pal does, like
<code>"roxygen"</code>) and an <code>interface</code> describing how the
pal will interact with the selection (one of <code>"replace"</code>,
<code>"prefix"</code>, or <code>"suffix"</code>). You can also
“pre-fill” the contents of the prompt by supplying a file path with the
<code>contents</code> argument.</p>
<p>For example, running:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prompt.html">prompt_new</a></span><span class="op">(</span><span class="st">"proofread"</span>, <span class="st">"replace"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/prompt.html">prompt_new</a></span><span class="op">(</span><span class="st">"summarize"</span>, <span class="st">"prefix"</span><span class="op">)</span></span></code></pre></div>
<p>Would result in a prompt directory that looks like:</p>
<pre><code>/
├── .config/
│   └── pal/
│       ├── proofread-replace.md
│       └── summarize-prefix.md</code></pre>
<p>In that case, pal would register two custom pals when you call
<code><a href="https://github.com/simonpcouch/pal" class="external-link">library(pal)</a></code> (or <code><a href="../reference/directory.html">directory_load()</a></code>. One of them
has the role <code>"proofread"</code> and will replace the selected text
with a proofread version (according to the instructions contained in the
markdown file itself). The other has the role <code>"summarize"</code>
and will prefix the selected text with a summarized version (again,
according to the markdown file’s instructions).</p>
<ul>
<li>Files without a <code>.md</code> extension are ignored.</li>
<li>Files with a <code>.md</code> extension must contain only one hyphen
in their filename, and the text following the hyphen must be one of
<code>replace</code>, <code>prefix</code>, or <code>suffix</code>.</li>
</ul>
<p>The best way to register pals for your own personal use is via the
prompt directory. However, if you intend to share pals with others, you
may be interested in creating a pal extension package.</p>
<!-- TODO: add note on how to add to the pal gallery -->
</div>
<div class="section level2">
<h2 id="extension-packages">Extension packages<a class="anchor" aria-label="anchor" href="#extension-packages"></a>
</h2>
<p>Pal extension packages allow you to more flexibly share pal prompts
with others. Putting together a pal extension package is
straightforward:</p>
<ul>
<li>Place one markdown file per new pal role in
<code>inst/prompts/</code>. This folder will take the same format as the
prompt directory described above.</li>
<li>Place a call to <code><a href="../reference/directory.html">pal::directory_load()</a></code> in the package’s
<code>.onLoad()</code>, referencing the extension package’s
<code>system.file("prompts", package = "yourpackage")</code>. This will
automatically register your package’s prompts with pal when the
extension is loaded.</li>
</ul>
<p>For an example pal extension, see <a href="https://github.com/simonpcouch/palpable" class="external-link">simonpcouch/palpable</a>.</p>
<p>Pal extension packages also allow you to document what your pals are
for and how they tend to behave in context; situate your documentation
files at <code>?pal_role</code>, replacing <code>role</code> with your
new pal role. Then, with your package loaded, users can view a
high-level description of the pal’s behavior and a gallery of examples.
See <code><a href="../reference/pal_cli.html">?pal_cli</a></code> for an example pal help-page, with source code
<a href="https://github.com/simonpcouch/pal/blob/main/R/doc-pal-cli.R" class="external-link">here</a>.</p>
<!-- TODO: add note on how to add to the pal gallery -->
</div>
<div class="section level2">
<h2 id="using-others-custom-pals">Using others’ custom pals<a class="anchor" aria-label="anchor" href="#using-others-custom-pals"></a>
</h2>
<p>Pal is designed to make it as easy as possible to always have the
pals you need on hand.</p>
<p><strong>To use others’ custom pals that aren’t situated in extension
packages</strong>, use <code><a href="../reference/prompt.html">prompt_new()</a></code> with a
<code>contents</code> argument. For example, Hannah Frick wrote a pal to
transition R code chunks from R Markdown-style chunk headers to Quarto’s
yaml syntax and uploaded it as a GitHub Gist <a href="https://gist.github.com/hfrick/1ca8fc2cb2a4409b743e8120c6cc2223#file-quartochunk-replace-md" class="external-link">here</a>.
To use her pal, we could write:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prompt.html">prompt_new</a></span><span class="op">(</span></span>
<span>  <span class="st">"quartochunk"</span>, </span>
<span>  <span class="st">"replace"</span>, </span>
<span>  contents <span class="op">=</span> <span class="st">"https://gist.githubusercontent.com/hfrick/1ca8fc2cb2a4409b743e8120c6cc2223/raw/a9703edfbd4e83839af0278c33add1b33e243d02/quartochunk-replace.md"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>After running that code, the <code>quartochunk</code> pal will be
available to you every time you trigger the pal addin.</p>
<p><strong>To use others’ custom pals from extension packages</strong>,
simply load the pal extension in your <code>.Rprofile</code>. You might
use <code>usethis::edit_r_profile()</code> to open the file, then drop
in the following line:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">palextensionname</span><span class="op">)</span></span></code></pre></div>
<p>Then, restart R, and that package’s pals will always be available to
you when you trigger the pal addin.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Simon Couch.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
